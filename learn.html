<!DOCTYPE HTML>
<html>

<head>
        <title>Learning Snacks - Firat Selcuk</title>
        <meta charset="utf-8">
        <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Short, searchable technical learning capsules. Learn web, APIs, databases, and more in 3-8 minutes.">
        <link rel="stylesheet" href="assets/css/main.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
        <style>
                /* Base styles to match template */
                body {
                        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
                        line-height: 1.6;
                        color: #333;
                }
                
                a {
                        color: #007bff;
                        text-decoration: none;
                }
                
                a:hover {
                        text-decoration: underline;
                }
                
                .search-filters {
                        background: #f8f9fa;
                        padding: 2rem;
                        border-radius: 12px;
                        margin: 2rem 0;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
                        border: 1px solid #e9ecef;
                }

                .search-bar {
                        width: 100%;
                        padding: 1rem 1.5rem;
                        font-size: 1rem;
                        border: 2px solid #e9ecef;
                        border-radius: 8px;
                        margin-bottom: 1.5rem;
                        transition: all 0.3s ease;
                        box-sizing: border-box;
                }

                .search-bar:focus {
                        outline: none;
                        border-color: #007bff;
                        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
                }

                .filters {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 1.5rem;
                        align-items: center;
                }

                .filter-group {
                        display: flex;
                        gap: 0.75rem;
                        flex-wrap: wrap;
                        align-items: center;
                }

                .filter-group label {
                        font-weight: 600;
                        color: #333;
                        font-size: 0.95rem;
                }

                .filter-btn {
                        padding: 0.5rem 1.25rem;
                        border: 2px solid #e9ecef;
                        background: white;
                        border-radius: 25px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        font-size: 0.9rem;
                        color: #495057;
                        font-weight: 500;
                }

                .filter-btn:hover {
                        border-color: #007bff;
                        background: #f0f7ff;
                        color: #007bff;
                }

                .filter-btn.active {
                        background: linear-gradient(135deg, #007bff, #0056b3);
                        color: white;
                        border-color: #007bff;
                }

                .capsules-grid {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                        gap: 2rem;
                        margin: 2rem 0;
                }

                .capsule-card {
                        background: #fff;
                        border: 1px solid #e9ecef;
                        border-radius: 12px;
                        padding: 2rem;
                        transition: all 0.3s ease;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
                        position: relative;
                        overflow: hidden;
                        cursor: pointer;
                        display: flex;
                        flex-direction: column;
                        text-decoration: none;
                        color: inherit;
                }

                .capsule-card::before {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: 0;
                        right: 0;
                        height: 4px;
                        background: linear-gradient(90deg, #007bff, #0056b3);
                }

                .capsule-card:hover {
                        transform: translateY(-8px);
                        box-shadow: 0 20px 40px rgba(0,0,0,0.15);
                        border-color: #007bff;
                }

                .capsule-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: start;
                        margin-bottom: 1rem;
                        margin-top: 0.5rem;
                }

                .capsule-title {
                        font-size: 1.3rem;
                        font-weight: bold;
                        color: #333;
                        margin: 0;
                        flex: 1;
                        line-height: 1.4;
                }

                .level-badge {
                        padding: 0.35rem 0.85rem;
                        border-radius: 20px;
                        font-size: 0.75rem;
                        font-weight: bold;
                        text-transform: uppercase;
                        letter-spacing: 0.5px;
                }

                .level-badge.beginner {
                        background: #d4edda;
                        color: #155724;
                }

                .level-badge.intermediate {
                        background: #fff3cd;
                        color: #856404;
                }

                .level-badge.advanced {
                        background: #f8d7da;
                        color: #721c24;
                }

                .capsule-meta {
                        display: flex;
                        gap: 1.5rem;
                        margin: 1rem 0;
                        font-size: 0.9rem;
                        color: #666;
                        flex-wrap: wrap;
                }

                .capsule-description {
                        color: #555;
                        line-height: 1.6;
                        margin: 1rem 0;
                        flex: 1;
                        font-size: 0.95rem;
                }

                .capsule-tags {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 0.5rem;
                        margin-top: auto;
                        padding-top: 1rem;
                }

                .tag {
                        background: #f8f9fa;
                        padding: 0.35rem 0.85rem;
                        border-radius: 15px;
                        font-size: 0.8rem;
                        color: #495057;
                        border: 1px solid #e9ecef;
                }

                .read-time {
                        display: flex;
                        align-items: center;
                        gap: 0.5rem;
                }

                .capsule-detail-modal {
                        display: none;
                        position: fixed;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: rgba(0,0,0,0.85);
                        z-index: 1000;
                        overflow-y: auto;
                        padding: 2rem;
                        backdrop-filter: blur(4px);
                }

                .capsule-detail-modal.active {
                        display: flex;
                        align-items: flex-start;
                        justify-content: center;
                        padding-top: 3rem;
                }

                .capsule-detail-content {
                        background: white;
                        border-radius: 16px;
                        max-width: 900px;
                        width: 100%;
                        max-height: 85vh;
                        overflow-y: auto;
                        padding: 3rem;
                        position: relative;
                        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                        margin-bottom: 2rem;
                }

                .close-btn {
                        position: absolute;
                        top: 1.5rem;
                        right: 1.5rem;
                        background: #f8f9fa;
                        border: 2px solid #e9ecef;
                        width: 42px;
                        height: 42px;
                        border-radius: 50%;
                        cursor: pointer;
                        font-size: 1.5rem;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: all 0.3s ease;
                        color: #495057;
                        z-index: 10;
                }

                .close-btn:hover {
                        background: #e9ecef;
                        transform: rotate(90deg);
                        border-color: #007bff;
                }

                .capsule-content {
                        line-height: 1.8;
                        color: #333;
                }

                .capsule-content h2 {
                        color: #667eea;
                        margin-top: 2rem;
                        margin-bottom: 1rem;
                }

                .capsule-content h3 {
                        color: #495057;
                        margin-top: 1.5rem;
                        margin-bottom: 0.75rem;
                }

                .capsule-content code {
                        background: #f8f9fa;
                        padding: 0.2rem 0.4rem;
                        border-radius: 4px;
                        font-family: 'Courier New', monospace;
                        font-size: 0.9em;
                }

                .capsule-content pre {
                        background: #f8f9fa;
                        padding: 1rem;
                        border-radius: 8px;
                        overflow-x: auto;
                        border-left: 4px solid #667eea;
                }

                .capsule-content ul, .capsule-content ol {
                        margin: 1rem 0;
                        padding-left: 2rem;
                }

                .capsule-content li {
                        margin: 0.5rem 0;
                }

                .quiz-section {
                        background: #f8f9fa;
                        padding: 1.5rem;
                        border-radius: 8px;
                        margin: 2rem 0;
                        border-left: 4px solid #667eea;
                }

                .quiz-question {
                        margin: 1.5rem 0;
                        padding: 1rem;
                        background: white;
                        border-radius: 8px;
                }

                .quiz-question h4 {
                        margin-bottom: 0.75rem;
                        color: #333;
                }

                .quiz-answer {
                        margin-top: 1rem;
                        padding: 0.75rem;
                        background: #e7f3ff;
                        border-left: 3px solid #667eea;
                        border-radius: 4px;
                        display: none;
                }

                .quiz-answer.revealed {
                        display: block;
                }

                .reveal-btn {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border: none;
                        padding: 0.5rem 1rem;
                        border-radius: 6px;
                        cursor: pointer;
                        margin-top: 0.5rem;
                        font-size: 0.9rem;
                        transition: transform 0.2s ease;
                }

                .reveal-btn:hover {
                        transform: translateY(-2px);
                }

                .pdf-download-btn {
                        background: linear-gradient(135deg, #28a745, #20c997);
                        color: white;
                        border: none;
                        padding: 0.75rem 1.5rem;
                        border-radius: 25px;
                        cursor: pointer;
                        font-weight: 500;
                        display: inline-flex;
                        align-items: center;
                        gap: 0.5rem;
                        margin-bottom: 2rem;
                        transition: all 0.3s ease;
                        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.2);
                }

                .pdf-download-btn:hover {
                        background: linear-gradient(135deg, #218838, #1ea085);
                        transform: translateY(-2px);
                        box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
                }

                @media print {
                        body * {
                                visibility: hidden;
                        }
                        .capsule-detail-content,
                        .capsule-detail-content * {
                                visibility: visible;
                        }
                        .capsule-detail-content {
                                position: absolute;
                                left: 0;
                                top: 0;
                                width: 100%;
                        }
                        .close-btn,
                        .pdf-download-btn,
                        .reveal-btn {
                                display: none !important;
                        }
                        .quiz-answer {
                                display: block !important;
                        }
                }

                .no-results {
                        text-align: center;
                        padding: 3rem;
                        color: #888;
                        grid-column: 1 / -1;
                }

                .loading {
                        text-align: center;
                        padding: 3rem;
                        color: #666;
                        grid-column: 1 / -1;
                }

                .section-header {
                        text-align: center;
                        margin-bottom: 3rem;
                }

                .section-header h2 {
                        font-size: 2.5rem;
                        margin-bottom: 1rem;
                        color: #333;
                }

                .section-header p {
                        font-size: 1.2rem;
                        color: #666;
                        max-width: 600px;
                        margin: 0 auto;
                }

                @media (max-width: 768px) {
                        .capsules-grid {
                                grid-template-columns: 1fr;
                        }

                        .filters {
                                flex-direction: column;
                                align-items: stretch;
                        }

                        .capsule-detail-content {
                                padding: 1rem;
                                margin: 1rem;
                        }
                }
        </style>
</head>

<body>
        <!-- Header -->
        <header id="header" class="alt">
                <div class="logo"><a href="index.html">Learning Snacks <span>by Firat</span></a></div>
                <a href="#menu">Menu</a>
        </header>

        <!-- Nav -->
        <nav id="menu">
                <ul class="links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="news.html">News</a></li>
                        <li><a href="innovation.html">Let's Innovate</a></li>
                        <li><a href="projects.html">Projects</a></li>
                        <li><a href="resources.html">Resources</a></li>
                        <li><a href="learn.html">Learn</a></li>
                        <li><a href="index.html#footer">Contacts</a></li>
                </ul>
        </nav>

        <!-- Banner -->
        <section id="banner">
                <div id="particles-js"></div>
                <div class="inner">
                        <header>
                                <h1>Learning Snacks</h1>
                                <p>Short, searchable technical capsules. Learn in 3-8 minutes.<br>
                                Perfect for quick learning and reference.</p>
                        </header>
                        <a href="#main" class="button big scrolly">Browse Capsules</a>
                </div>
        </section>

        <!-- Main Content -->
        <div id="main" class="container">
                <!-- Search Section -->
                <section class="wrapper style2">
                        <div class="inner">
                                <div class="section-header">
                                        <h2>Browse Learning Capsules</h2>
                                        <p>Search and filter by topic, difficulty, or tags</p>
                                </div>

                                <!-- Search and Filters -->
                                <div class="search-filters">
                                        <input type="text" id="searchInput" class="search-bar" placeholder="ðŸ” Search capsules by title, description, or tags...">
                                        <div class="filters">
                                                <div class="filter-group">
                                                        <label>Level:</label>
                                                        <button class="filter-btn" data-filter="level" data-value="beginner">Beginner</button>
                                                        <button class="filter-btn" data-filter="level" data-value="intermediate">Intermediate</button>
                                                        <button class="filter-btn" data-filter="level" data-value="advanced">Advanced</button>
                                                </div>
                                                <div class="filter-group">
                                                        <label>Category:</label>
                                                        <button class="filter-btn" data-filter="category" data-value="web">Web</button>
                                                        <button class="filter-btn" data-filter="category" data-value="apis">APIs</button>
                                                        <button class="filter-btn" data-filter="category" data-value="auth">Auth</button>
                                                        <button class="filter-btn" data-filter="category" data-value="databases">Databases</button>
                                                        <button class="filter-btn" data-filter="category" data-value="streaming">Streaming</button>
                                                </div>
                                        </div>
                                </div>
                        </div>
                </section>

                <!-- Capsules Display Section -->
                <section class="wrapper style1">
                        <div class="inner">
                                <!-- Capsules Grid -->
                                <div id="capsulesContainer" class="capsules-grid">
                                        <div class="loading">
                                                <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                                                <p>Loading capsules...</p>
                                        </div>
                                </div>
                        </div>
                </section>
        </div>

        <!-- Capsule Detail Modal -->
        <div id="capsuleModal" class="capsule-detail-modal">
                <div class="capsule-detail-content">
                        <button class="close-btn" onclick="closeCapsuleModal()">&times;</button>
                        <button class="pdf-download-btn" id="pdfDownloadBtn" onclick="downloadPDF()">
                                <i class="fas fa-download"></i> Download PDF
                        </button>
                        <div id="capsuleDetailContent" class="capsule-content"></div>
                </div>
        </div>

        <!-- Footer -->
        <footer id="footer">
                <div class="copyright">
                        <ul class="icons">
                                <li><a href="https://twitter.com/firatsselcuk" class="icon fab fa-twitter" target="_blank"><span
                                                        class="label">Twitter</span></a></li>
                                <li><a href="https://www.linkedin.com/in/firat-selcuk-64b4b6231/" class="icon fab fa-linkedin"
                                                target="_blank"><span class="label">Linkedin</span></a></li>
                                <li><a href="https://github.com/FiratSS" class="icon fab fa-github" target="_blank"><span
                                                        class="label">GitHub</span></a></li>
                                <li><a href="mailto:firatselcuk010@gmail.com" class="icon fas fa-envelope" target="_blank"><span
                                                        class="label">Email</span></a></li>
                        </ul>
                </div>
        </footer>
        <div class="copyright">
                <p>&copy; 2025 Firat Selcuk. All rights reserved.</p>
        </div>

        <!-- Scripts -->
        <script src="assets/js/jquery.min.js"></script>
        <script src="assets/js/jquery.scrolly.min.js"></script>
        <script src="assets/js/jquery.scrollex.min.js"></script>
        <script src="assets/js/skel.min.js"></script>
        <script src="assets/js/util.js"></script>
        <script src="assets/js/main.js"></script>
        <script src="assets/js/particles.min.js"></script>

        <!-- Particles.js configuration -->
        <script>
                particlesJS.load('particles-js', 'assets/js/particles.json', function () {
                        console.log('particles.json loaded...');
                });
        </script>

        <!-- Learning Capsules Script -->
        <script>
                let allCapsules = [];
                let filteredCapsules = [];
                let activeFilters = {
                        level: null,
                        category: null,
                        search: ''
                };

                // Load capsules
                async function loadCapsules() {
                        try {
                                const response = await fetch('assets/learn/index.json');
                                const data = await response.json();
                                allCapsules = data.capsules;
                                filteredCapsules = allCapsules;
                                displayCapsules();
                        } catch (error) {
                                console.error('Error loading capsules:', error);
                                document.getElementById('capsulesContainer').innerHTML = 
                                        '<div class="no-results"><i class="fas fa-exclamation-circle" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i><p>Unable to load capsules. Please try again later.</p></div>';
                        }
                }

                // Display capsules
                function displayCapsules() {
                        const container = document.getElementById('capsulesContainer');
                        
                        if (filteredCapsules.length === 0) {
                                container.innerHTML = '<div class="no-results"><i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i><p>No capsules found. Try adjusting your filters.</p></div>';
                                return;
                        }

                        let html = '';
                        filteredCapsules.forEach(capsule => {
                                html += `
                                        <div class="capsule-card" onclick="event.preventDefault(); event.stopPropagation(); showCapsuleDetail('${capsule.id}'); return false;">
                                                <div class="capsule-header">
                                                        <h3 class="capsule-title">${escapeHtml(capsule.title)}</h3>
                                                        <span class="level-badge ${capsule.level}">${capsule.level}</span>
                                                </div>
                                                <div class="capsule-meta">
                                                        <span class="read-time">
                                                                <i class="far fa-clock"></i>
                                                                ${capsule.readTime} min read
                                                        </span>
                                                        <span style="text-transform: capitalize; font-weight: 500;">${capsule.category}</span>
                                                </div>
                                                <p class="capsule-description">${escapeHtml(capsule.description)}</p>
                                                <div class="capsule-tags">
                                                        ${capsule.tags.map(tag => `<span class="tag">${escapeHtml(tag)}</span>`).join('')}
                                                </div>
                                        </div>
                                `;
                        });
                        container.innerHTML = html;
                }

                let currentCapsule = null;

                // Show capsule detail
                async function showCapsuleDetail(capsuleId) {
                        currentCapsule = allCapsules.find(c => c.id === capsuleId);
                        if (!currentCapsule) {
                                console.error('Capsule not found:', capsuleId);
                                return;
                        }

                        // Show modal immediately with loading state
                        const modal = document.getElementById('capsuleModal');
                        const modalContent = document.getElementById('capsuleDetailContent');
                        modalContent.innerHTML = '<div style="text-align: center; padding: 3rem;"><i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i><p>Loading...</p></div>';
                        modal.classList.add('active');
                        document.body.style.overflow = 'hidden';

                        try {
                                const filePath = `assets/learn/${currentCapsule.file}`;
                                console.log('Fetching:', filePath);
                                
                                const response = await fetch(filePath);
                                
                                if (!response.ok) {
                                        throw new Error(`HTTP error! status: ${response.status}`);
                                }
                                
                                const markdown = await response.text();
                                
                                if (!markdown || markdown.trim().length === 0) {
                                        throw new Error('Empty markdown file');
                                }
                                
                                // Extract frontmatter if present
                                let content = markdown;
                                if (markdown.startsWith('---')) {
                                        const frontmatterEnd = markdown.indexOf('---', 4);
                                        if (frontmatterEnd !== -1) {
                                                content = markdown.substring(frontmatterEnd + 3).trim();
                                        }
                                }

                                // Configure marked for code highlighting
                                if (typeof marked !== 'undefined') {
                                        marked.setOptions({
                                                highlight: function(code, lang) {
                                                        if (lang && typeof Prism !== 'undefined' && Prism.languages[lang]) {
                                                                return Prism.highlight(code, Prism.languages[lang], lang);
                                                        }
                                                        return code;
                                                }
                                        });

                                        // Render markdown
                                        let html = marked.parse(content);
                                        
                                        // Enhance quiz questions with interactive reveals
                                        html = enhanceQuizQuestions(html, currentCapsule);
                                        
                                        modalContent.innerHTML = `
                                                <h1>${escapeHtml(currentCapsule.title)}</h1>
                                                <div class="capsule-meta" style="margin-bottom: 2rem;">
                                                        <span class="level-badge ${currentCapsule.level}">${currentCapsule.level}</span>
                                                        <span class="read-time">
                                                                <i class="far fa-clock"></i>
                                                                ${currentCapsule.readTime} min read
                                                        </span>
                                                </div>
                                                ${html}
                                        `;
                                        
                                        // Re-run Prism highlighting after content is inserted
                                        if (typeof Prism !== 'undefined') {
                                                Prism.highlightAllUnder(modalContent);
                                        }
                                } else {
                                        throw new Error('Marked.js library not loaded');
                                }
                                
                                // Reset scroll to top - wait a moment for modal to render
                                setTimeout(() => {
                                        const modalContentDiv = document.querySelector('.capsule-detail-content');
                                        if (modalContentDiv) {
                                                modalContentDiv.scrollTop = 0;
                                        }
                                }, 100);
                        } catch (error) {
                                console.error('Error loading capsule:', error);
                                modalContent.innerHTML = `
                                        <div style="text-align: center; padding: 3rem; color: #e74c3c;">
                                                <i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
                                                <h2>Error Loading Capsule</h2>
                                                <p>Unable to load capsule content. Please try again later.</p>
                                                <p style="font-size: 0.9rem; color: #888; margin-top: 1rem;">Error: ${error.message}</p>
                                                <button onclick="closeCapsuleModal()" style="margin-top: 2rem; padding: 0.75rem 2rem; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer;">Close</button>
                                        </div>
                                `;
                        }
                }

                // Enhance quiz questions with reveal buttons
                function enhanceQuizQuestions(html, capsule) {
                        // Process HTML to find quiz sections
                        const tempDiv = document.createElement('div');
                        tempDiv.innerHTML = html;
                        
                        // Find quiz section heading
                        const headings = Array.from(tempDiv.querySelectorAll('h2, h3'));
                        headings.forEach(heading => {
                                const headingText = heading.textContent.toLowerCase();
                                if (headingText.includes('quiz')) {
                                        // Find the list after the quiz heading
                                        let current = heading.nextElementSibling;
                                        while (current && current.tagName !== 'H2' && current.tagName !== 'H3') {
                                                if (current.tagName === 'OL' || current.tagName === 'UL') {
                                                        const items = current.querySelectorAll('li');
                                                        items.forEach(item => {
                                                                const text = item.textContent.trim();
                                                                // Check if it's a question (ends with ? or starts with number)
                                                                if (text.includes('?') || text.match(/^\d+\./)) {
                                                                        const questionDiv = document.createElement('div');
                                                                        questionDiv.className = 'quiz-question';
                                                                        
                                                                        // Extract question text
                                                                        const questionText = text.replace(/^\d+\.\s*/, '').trim();
                                                                        
                                                                        questionDiv.innerHTML = `
                                                                                <h4>${escapeHtml(questionText)}</h4>
                                                                                <button class="reveal-btn" onclick="this.nextElementSibling.classList.add('revealed'); this.style.display='none';">Reveal Hint</button>
                                                                                <div class="quiz-answer">
                                                                                        <strong>ðŸ’¡ Think about it:</strong> Review the key concepts above. Consider how ${escapeHtml(capsule.title)} works and what you learned about it.
                                                                                </div>
                                                                        `;
                                                                        
                                                                        item.parentNode.replaceChild(questionDiv, item);
                                                                }
                                                        });
                                                }
                                                current = current.nextElementSibling;
                                        }
                                }
                        });
                        
                        return tempDiv.innerHTML;
                }

                // Download PDF
                function downloadPDF() {
                        window.print();
                }

                // Close modal
                function closeCapsuleModal() {
                        document.getElementById('capsuleModal').classList.remove('active');
                        document.body.style.overflow = '';
                }

                // Filter capsules
                function filterCapsules() {
                        filteredCapsules = allCapsules.filter(capsule => {
                                // Level filter
                                if (activeFilters.level && capsule.level !== activeFilters.level) {
                                        return false;
                                }
                                
                                // Category filter
                                if (activeFilters.category && capsule.category !== activeFilters.category) {
                                        return false;
                                }
                                
                                // Search filter
                                if (activeFilters.search) {
                                        const searchLower = activeFilters.search.toLowerCase();
                                        const matchesTitle = capsule.title.toLowerCase().includes(searchLower);
                                        const matchesDescription = capsule.description.toLowerCase().includes(searchLower);
                                        const matchesTags = capsule.tags.some(tag => tag.toLowerCase().includes(searchLower));
                                        
                                        if (!matchesTitle && !matchesDescription && !matchesTags) {
                                                return false;
                                        }
                                }
                                
                                return true;
                        });
                        
                        displayCapsules();
                }

                // Search input handler
                document.getElementById('searchInput').addEventListener('input', (e) => {
                        activeFilters.search = e.target.value;
                        filterCapsules();
                });

                // Filter button handlers
                document.querySelectorAll('.filter-btn').forEach(btn => {
                        btn.addEventListener('click', () => {
                                const filterType = btn.dataset.filter;
                                const filterValue = btn.dataset.value;
                                
                                // Toggle filter
                                if (activeFilters[filterType] === filterValue) {
                                        activeFilters[filterType] = null;
                                        btn.classList.remove('active');
                                } else {
                                        // Remove active class from siblings
                                        document.querySelectorAll(`[data-filter="${filterType}"]`).forEach(b => b.classList.remove('active'));
                                        activeFilters[filterType] = filterValue;
                                        btn.classList.add('active');
                                }
                                
                                filterCapsules();
                        });
                });

                // Close modal on outside click
                document.getElementById('capsuleModal').addEventListener('click', (e) => {
                        if (e.target.id === 'capsuleModal') {
                                closeCapsuleModal();
                        }
                });

                // Escape key to close modal
                document.addEventListener('keydown', (e) => {
                        if (e.key === 'Escape') {
                                closeCapsuleModal();
                        }
                });

                // Escape HTML
                function escapeHtml(text) {
                        const div = document.createElement('div');
                        div.textContent = text;
                        return div.innerHTML;
                }

                // Load capsules on page load
                document.addEventListener('DOMContentLoaded', loadCapsules);
        </script>
</body>

</html>

